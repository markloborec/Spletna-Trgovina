<div class="backdrop" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
        <button class="close-btn" type="button" (click)="closeModal()">‚úï</button>

        <!-- HEADER -->
        <div class="header">
            <h2 class="title">{{ product?.name }}</h2>

            <div class="meta">
                <span class="chip" *ngIf="product?.type as t">
                    Tip:
                    <ng-container [ngSwitch]="t">
                        <span *ngSwitchCase="'cycles'">Kolo</span>
                        <span *ngSwitchCase="'equipment'">Oprema</span>
                        <span *ngSwitchCase="'clothing'">Oblaƒçila</span>
                        <span *ngSwitchDefault>{{ t }}</span>
                    </ng-container>
                </span>

                <span class="chip" *ngIf="product?.id">ID: {{ product.id }}</span>

                <span class="chip" [class.ok]="product?.isAvailable" [class.bad]="product && !product.isAvailable">
                    {{ product?.isAvailable ? 'Na zalogi' : 'Ni na zalogi' }}
                </span>
            </div>
        </div>

        <!-- IMAGE -->
        <div class="image-wrap">
            <img *ngIf="product?.imageUrl; else noImage" [src]="product.imageUrl" [alt]="product?.name || 'Produkt'"
                class="product-image" loading="lazy" />
            <ng-template #noImage>
                <div class="no-image">
                    <span class="emoji">
                        {{
                        product?.type === 'cycles'
                        ? 'üö≤'
                        : product?.type === 'clothing'
                        ? 'üëï'
                        : 'üß∞'
                        }}
                    </span>
                    <div class="no-image-text">Ni slike</div>
                </div>
            </ng-template>
        </div>

        <!-- PRICE -->
        <p class="price">
            {{ product?.price | currency : 'EUR' : 'symbol' : '1.2-2' : 'sl-SI' }}
        </p>

        <!-- COMMON FIELDS -->
        <div class="section">
            <h3>Osnovne informacije</h3>

            <div class="row">
                <span class="label">Kratki opis</span>
                <span class="value">
                    {{ product?.shortDescription || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">Dolgi opis</span>
                <span class="value">
                    {{ product?.longDescription || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">Garancija</span>
                <span class="value">
                    {{ product?.warrantyMonths ?? '‚Äî' }} <ng-container
                        *ngIf="product?.warrantyMonths != null">mesecev</ng-container>
                </span>
            </div>

            <div class="row">
                <span class="label">Uradna stran</span>
                <span class="value">
                    <a *ngIf="product?.officialProductSite; else noSite" [href]="product.officialProductSite"
                        target="_blank" rel="noopener noreferrer" (dblclick)="$event.stopPropagation()">
                        Odpri uradno stran
                    </a>
                    <ng-template #noSite>‚Äî</ng-template>
                </span>
            </div>
        </div>

        <!-- BICYCLE FIELDS -->
        <div class="section" *ngIf="product?.type === 'cycles'">
            <h3>Specifikacije kolesa</h3>

            <div class="row">
                <span class="label">Velikost obroƒçev</span>
                <span class="value">
                    {{ product?.wheelSize ?? '‚Äî' }}<ng-container *ngIf="product?.wheelSize != null">"</ng-container>
                </span>
            </div>

            <div class="row">
                <span class="label">Material okvirja</span>
                <span class="value">
                    {{ product?.frameMaterial || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">≈†tevilo prestav</span>
                <span class="value">
                    {{ product?.gearCount ?? '‚Äî' }}
                </span>
            </div>
        </div>

        <!-- CLOTHING FIELDS -->
        <div class="section" *ngIf="product?.type === 'clothing'">
            <h3>Specifikacije oblaƒçila</h3>

            <div class="row">
                <span class="label">Velikost</span>
                <span class="value">
                    {{ product?.size || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">Spol</span>
                <span class="value">
                    <ng-container *ngIf="product?.gender as g; else genderDash">
                        <ng-container [ngSwitch]="g">
                            <span *ngSwitchCase="'male'">mo≈°ki</span>
                            <span *ngSwitchCase="'female'">≈æenski</span>
                            <span *ngSwitchCase="'unisex'">unisex</span>
                            <span *ngSwitchDefault>{{ g }}</span>
                        </ng-container>
                    </ng-container>
                    <ng-template #genderDash>‚Äî</ng-template>
                </span>
            </div>

            <div class="row">
                <span class="label">Material</span>
                <span class="value">
                    {{ product?.material || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">Barva</span>
                <span class="value">
                    {{ product?.color || '‚Äî' }}
                </span>
            </div>
        </div>

        <!-- EQUIPMENT FIELDS -->
        <div class="section" *ngIf="product?.type === 'equipment'">
            <h3>Specifikacije opreme</h3>

            <div class="row">
                <span class="label">Znamka</span>
                <span class="value">
                    {{ product?.brand || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">Material</span>
                <span class="value">
                    {{ product?.material || '‚Äî' }}
                </span>
            </div>

            <div class="row">
                <span class="label">Te≈æa</span>
                <span class="value">
                    {{ product?.weight ?? '‚Äî' }}
                    <ng-container *ngIf="product?.weight != null"> g</ng-container>
                </span>
            </div>

            <div class="row">
                <span class="label">Kompatibilnost</span>
                <span class="value">
                    <ng-container *ngIf="product?.compatibility?.length; else compDash">
                        <ul class="list">
                            <li *ngFor="let c of product.compatibility">{{ c }}</li>
                        </ul>
                    </ng-container>
                    <ng-template #compDash>‚Äî</ng-template>
                </span>
            </div>
        </div>
    </div>
</div>